// Protocol for bidding //

Client.makeBid(Client,bid) -> Server.Vtupple(Client,bid)
if max(Vtupple(Client)) @Server then
    Server.update(maxBid) -> Client.("getBid")
    Client.("getResponse") -> server.request("getResponse")
else
    Server.("Bid too low") -> Client.response(string)
Client("getMaxBid") -> server.request("getMaxBid")





// SPØRG (TA) : Benjamin eller magnus

// Server projection // pt.2
Server:

    maxBid := channel(Server, Client).get(Client, bid)
    if max(maxBid) then
        channel(Server, Client).put("then")
        bidChannel(Server).put(maxBid)
        channel(Server, Client).put("Your bid is currently max")
    else
        channel(Server, Client).put("else")
        channel(Server, Client).put("bid too low")
    channel(Server, Client).put("getMaxBid")

Client:

   / maxBid := channel(Client, Server).put(Client, bid)
   / branch := channel(Server, Client).get(string)
   / if branch == "then" then
   /     channel(Client, Server).get(string)
   / else


    maxBid := channel(Client, Server).put(Client, bid)
    channel(Client, Server).get(string)






// Server projection // pt.1

project(biddigProtocol, Server)

project(Line1 ; Line2to6)

project(Line1, Server)
project(Line2to6, Server)

project(Client.makeBid(Client,bid) -> Server.Vtupple(Client,bid), Server) ;
project(Line2to6)

channel(Server, Client).put(Client, bid) ;




// Informal description




par

  walletHolder_1.put(0);
  walletHolder_2.put(0);
  time.put(0);
  sellerInventory.put(0)

[]

  loop true -> walletHolder_1.get(0);
               bidPlaced.put(0)
  pool

[]
  loop true -> walletHolder_2.get(0);
               minimum_bid_userID.put(0)
  pool

[]
  loop true -> Time_token.get(0);
               bidPlaced.get(0);
               sellerwallet.put(0);
               buyer_inventory.put(0)
  pool

[]
  loop true -> sellerwallet.get(0)
  pool

[]
  loop true -> buyer_inventory.get(0)
  pool

[]
  loop true -> reserveItem.get(0)
  pool


rap



// nyt forsøg



par

/* init:
  wallet_1.put(0);
  wallet_2.put(2)
  time_token.put(-1);
  sellerInventory.put(-2)


*/
par

  wallet_1.get(0)
  wallet_2.get(0)
  walletHolder_1.put(0);
  walletHolder_2.put(2);

[]

  loop true -> walletHolder_1.get(0);
               bidPlaced.put(0)
  pool

[]
  loop true -> walletHolder_2.get(0);
               bidPlaced.put(0)
  pool

[]
  loop true -> bidPlaced.get(0);
               wallet_2.put(0)
  pool

[]
  loop true -> Time_token.get(-1);
               bidPlaced.get(0);
               sellerwallet.put(0);
               sellerInventory.get(-2);
               buyer_inventory.put(-2)
  pool

rap